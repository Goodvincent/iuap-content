# 异常处理

异常是报告错误的标准机制，当违反语义约束时，Java将抛出一个异常，并且将程序执行的控制流从异常发生的点转移到用户指定的点。异常也可以被显式地使用throw关键字来抛出。
## 5.1.1 异常的定义
Java定义了一个异常类的层次结构,其以Throwable开始，扩展出Error和Exception，而Exception又扩展出RuntimeException. 这四个类是泛化的，并不提供多少出错信息，除了Java提供了大量异常子类，例如iUAP平台的部分组件中提供了如 BusinessException，WebRuntimeException等异常类型。如需更加具体，可以定义自己的异常类。 在定义和使用异常的时候要遵循以下几个原则：
•	不要将异常用于控制流,仅为异常情况使用异常；
•	对可恢复异常情况使用检查型异常；对编程错误如前置条件错误等情况使用运行时     异常；
•	避免使用不必要的检查型异常,不要对调用者根本就不可能恢复的情况或者说可以预见到必然会使程序退出的情况使用检查型异常；
•	抛出异常应与抽象层次相适应，方法抛出的异常必须和该方法所实现的功能在抽象层次上一致。
## 5.1.2 异常的抛出
Java语言规范中给出了三个抛出异常的原因：
（1）Java虚拟机同步（synchronized）检测到反常的（abnormal）执行条件，这些条件可能由下列条件触发：
	对表达式的求值违反了语言的语义，例如除0等
	加载或链接程序某部分的时候发生了错误
	超出了某些资源的限制，比如内存不足等
（2）throw语句被执行
（3）发生了异步异常
	Thread或ThreadGroup的stop方法被调用
	虚拟机发生了内部错误 Java语言规范也明确指出了异常的三种类型：RuntimeException、Error和checkedException（检查型异常）。第一种类型的异常称为非检查型异常（uncheckedException），不需要声明，所以不需要程序员显式地使用try...catch语句来捕获它们；而后面两种则要求声明，即必须使用try...catch来捕获并处理。
通过提早抛出异常（又称＂迅速失败＂），异常得以清晰又准确。堆栈信息立即反映出错的原因和位置，其中包含的异常信息应提供更加丰富的信息用来定位问题。迅速失败可以有效避免不必要的对象构造或资源占用。
## 5.1.3 异常的捕获
Java可以对同一try块定义多个catch块，从而对每种异常分别进行恰当的处理。捕获异常时尽量明确异常的类型，对于当前程序没有能力处理这个异常的时候不要处理，应该在方法的throws子句声明异常，把异常处理的责任往调用链的上游传递。 过早捕获异常，通常会导致更严重的错误和其他异常。不要不分类型就立即将代码用try块包装起来并使用catch捕获异常。
对于泛化异常，应该捕获具体的异常并且传递给用户可以看懂的信息。 例如iUAP框架的iweb组件中提供了 com.yonyou.iuap.iweb.exception.WebRuntimeException 的运行时异常,可以通过WebRuntimeException.setHint(String hint) 方法设置要传递给用户的信息。
